<script>
  import { onMount } from 'svelte';
  const title = 'OST ì•„ì¹´ì´ë¸Œ';
  
  const songs = [
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2024 ê°€ì„", url: "https://cdn.kkutu.io/media/LobbyBGM_2024_Fall.mp3", artist: "BGM Farm", cover: "fall2024" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ ì‹ ë…„ë§ì´", url: "https://cdn.kkutu.io/media/LobbyBGM_2023_Winter.mp3", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2022 ê°€ì„", url: "https://pub-e336c74b058c476bb58f9267c51fbab4.r2.dev/2022Fall.flac", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 6ì£¼ë…„", url: "https://pub-e336c74b058c476bb58f9267c51fbab4.r2.dev/20236th.flac", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2017", url: "https://cdn.kkutu.io/media/LobbyBGM_2017.mp3", artist: "KKuTuIO", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2023 ì—¬ë¦„", url: "https://pub-e336c74b058c476bb58f9267c51fbab4.r2.dev/2023Summer.flac", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2024 ë´„", url: "https://cdn.kkutu.io/media/LobbyBGM_2024_Spring.mp3", artist: "Hexacube", cover: "null" },
    { title: "ìƒˆë¡œìš´ ì‹œì‘", url: "https://cdn.kkutu.io/media/LobbyBGM_NEW.mp3", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2020 ê°€ì„", url: "https://cdn.kkutu.io/media/LobbyBGM_2020_Fall.mp3", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ Lo-fi", url: "https://cdn.kkutu.io/media/LobbyBGM_Plus_S2.mp3", artist: "Roman Rajczyk", cover: "plusS2" },
    { title: "ë‹¤í•¨ê»˜ ë„íˆ¬ë¦¬ì˜¤!", url: "https://cdn.kkutu.io/media/LobbyBGM_Plus_S1.mp3", artist: "Xpolcore", cover: "plusS1" },
    { title: "ì˜¤ë¦¬ì§€ë„ ë„íˆ¬", url: "https://cdn.kkutu.io/media/LobbyBGM.mp3", artist: "JJoriping", cover: "kkutu" },
    { title: "ë„íˆ¬ ëª…ì ˆ", url: "https://cdn.kkutu.io/media/LobbySeolBGM.mp3", artist: "JJoriping", cover: "kkutu" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ ëª…ì ˆ", url: "https://cdn.kkutu.io/media/LobbyBGM_KKuTuIO_Seol.mp3", artist: "KKuTuIO", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2020 ì—¬ë¦„", url: "https://cdn.kkutu.io/media/LobbyBGM_2020_Summer.mp3", artist: "Hexacube", cover: "null" },
    { title: "Breakdown Fragment", url: "https://pub-e336c74b058c476bb58f9267c51fbab4.r2.dev/Breakdown_Fragment.mp3", artist: "Hexacube", cover: "null" },
    { title: "ë„íˆ¬ë¦¬ì˜¤ 2020 ê²¨ìš¸", url: "https://cdn.kkutu.io/media/LobbyBGM_2020_Winter.mp3", artist: "Hexacube", cover: "null" }
  ];

  let currentSong = null;
  
  function playSong(song) {
    currentSong?.pause();
    currentSong = new Audio(song.url);
    currentSong.play();
    currentSong.loop = true;
  }
</script>

<svelte:head>
  <title>ë„íˆ¬ë¦¬ì˜¤ - {title}</title>
</svelte:head>
<div class="dark:bg-gray-900">
  <div class="pt-24 mx-auto max-w-screen-xl px-4 py-8 ">
    <div class="flex items-center justify-between mb-8">
      <div>
        <h1 class="dark:text-white text-3xl font-bold mb-2">OST ì•„ì¹´ì´ë¸Œ</h1>
        <p class="text-gray-500 dark:text-gray-300 mb-8"><strong>ì—¬ëŸ¬ë¶„ì˜ ì†ìœ¼ë¡œ ê¼½ì€ ìµœê³ ì˜ OST!</strong> ì„¤ë¬¸ì¡°ì‚¬ì˜ ì¸ê¸°ë„ë¥¼ ë°˜ì˜í–ˆìŠµë‹ˆë‹¤.<br>ë„íˆ¬ë¦¬ì˜¤ì˜ ë‹¤ì–‘í•œ OSTë¥¼ ê°ìƒí•´ë³´ì„¸ìš”.</p>
      </div>
      <div>
        <button class="bg-[#55aa55] hover:bg-[#51a351] text-white flex rounded-lg py-1 px-3 transform ease-in duration-100 active:scale-95"
        on:click={() => {
          if (currentSong) {
            currentSong.pause();
            currentSong = null;
          } else {
            playSong(songs[Math.floor(Math.random() * songs.length)]);
          }
        }}
        >
            { currentSong ? "âšâš ì¼ì‹œ ì •ì§€" : "ğŸ”€ ëœë¤ ì¬ìƒ" }
        </button>
      </div>
    </div>
    <ul class="grid grid-cols-1 lg:grid-cols-3 gap-4">
      {#each songs as song}
        <button class="text-left flex items-center justify-between p-4 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transform ease-in duration-100 active:scale-95"
            on:click={() => playSong(song)}>
          <div class="flex">
            <div>
              <img src={ song.cover == "null" ? "https://cdn.kkutu.io/img/bgm/default.png" : "https://cdn.kkutu.io/img/bgm/"+song.cover+".png" } alt="OST" class="w-12 h-12 rounded-lg bg-gray-500 mr-4" />
            </div>
            <div>
              <h3 class="text-lg font-bold dark:text-white">{song.title}</h3>
              <span class="text-sm text-gray-500 dark:text-gray-300">
                {#if song.url.endsWith('.flac')}
                  <span class="bg-[#E0582B] text-white px-1 rounded-full">FLAC</span>
                {/if}
                {song.artist}
              </span>
            </div>
          </div>
        </button>
      {/each}
    </ul>
  </div>
</div>